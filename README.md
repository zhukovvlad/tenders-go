# tenders-go

**tenders-go** — это серверная часть для управления тендерами и заявками, написанная на Go и использующая PostgreSQL в качестве базы данных. Проект ориентирован на автоматизацию процессов проведения тендеров, работы с предложениями подрядчиков, детализацию лотов и расширенную аналитику.

## Основные возможности

- **Иерархия справочников**: трехуровневая структура тендеров с поддержкой категорий и разделов (`tender_types`, `tender_chapters`, `tender_categories`).
- **Ведение тендеров и лотов**: создание, обновление, удаление тендеров и лотов с защитой целостности данных.
- **Работа с подрядчиками и предложениями**: поддержка сложных аналитических запросов, детализация предложений, массовое обновление, обработка контактных лиц.
- **Семантический поиск**: поиск по векторам (RAG) с использованием HNSW-индексов для анализа документов и данных лота.
- **Гибкая система обновления**: паттерн частичного обновления записей через COALESCE, что позволяет безопасно изменять только нужные поля.
- **Пагинация**: все запросы, возвращающие списки, поддерживают пагинацию для высокой производительности и предсказуемости.

## Структура репозитория

- `cmd/internal/db/query/` — SQL-запросы для каждой таблицы/логической группы, используемые с генератором кода [sqlc](https://sqlc.dev/).
- `cmd/internal/db/migration/` — миграции для создания и изменения схемы базы данных.
- Go-код, взаимодействующий с базой данных, с обработкой ошибок и поддержкой транзакций.

## Технологии

- **Go** — основной язык реализации бизнес-логики и API.
- **PostgreSQL** — используемая СУБД, поддерживаются каскадные и ограничительные операции при удалении данных.
- **sqlc** — генерация strongly-typed Go кода на основе SQL-запросов.

## Ключевые сущности

- **Тендеры** (`tenders`)
- **Лоты** (`lots`)
- **Объекты и исполнители** (`objects`, `executors`)
- **Подрядчики и контактные лица** (`contractors`, `persons`)
- **Предложения и победители** (`proposals`, `winners`)
- **Детализация позиций и аналитика** (`position_items`, `proposal_summary_lines`, `lots_md_documents`, `lots_chunks` и др.)

## Принципы работы с удалением

- `ON DELETE RESTRICT` — предотвращает удаление записей, на которые есть ссылки.
- `ON DELETE CASCADE` — каскадное удаление связанных сущностей.
- Внимание к контролю целостности данных, обработка ошибок на уровне приложения.

## TODO

Список актуальных задач по доработке SQL-запросов и логики приложения находится в [`cmd/internal/db/query/TODO.md`](cmd/internal/db/query/TODO.md).

## Контрибьюция

PR и багрепорты приветствуются! Для задач по оптимизации или изменению структуры данных — согласовывайте архитектуру заранее.

---

**Автор:** [zhukovvlad](https://github.com/zhukovvlad)
